<%= form_with method: :get, data: { controller: "cost-of-parenting tabs", tabs_default_tab_value: "1", turbo_frame: frame_id } do |form| %>
  <span class="text-sm text-gray-900 font-medium">Details</span>
  <div class="flex flex-col gap-2">
    <%= form.unit_field :yearly_household_income, label: "Yearly household income", value: tool.yearly_household_income, unit_symbol: "$", data: { controller: "autonumeric" } %>
  </div>
  <%= render partial: "shared/select_increment", locals: { label: "Amount of children", value: tool.children, min: 1, max: 10, name: "children", decrement_callback: "decrementCallback", increment_callback: "incrementCallback" } %>

    <div class="bg-black bg-opacity-[3%] p-1 rounded-[10px] flex flex-row w-full mb-8 hidden" data-cost-of-parenting-target="childrenTabs">
      <% 10.times do |i| %>
        <button class="tab-item hidden" type="button" id="<%= i + 1 %>" data-tabs-target="btn" data-action="click->tabs#select">#<%= i + 1 %></button>
      <% end %>
    </div>

  <% 10.times do |i| %>
    <div data-tabs-target="tab" id="<%= i + 1 %>">
      <div class="flex flex-col gap-2 mt-4">
        <%= form.check_box "child_#{i + 1}_will_need_daycare", label: "Will need daycare" %>
        <%= form.check_box "child_#{i + 1}_will_go_to_private_school", label: "Will go to a private school" %>
        <%= form.check_box "child_#{i + 1}_will_go_to_college", label: "Will go to college" %>
        <%= form.check_box "child_#{i + 1}_will_need_private_tutoring", label: "Will need private tutoring" %>
        <%= form.check_box "child_#{i + 1}_will_go_to_summer_camp", label: "Will go to summer camp" %>
        <%= form.check_box "child_#{i + 1}_will_play_sports", label: "Will play sports, music or other extracurricular activities throughout adolescence" %>
      </div>
    </div>
  <% end %>
<div class="mt-6"></div>
  <span class="text-sm text-gray-900 font-medium">Expenses</span>
  <div class="flex flex-col gap-2">
    <%= form.unit_field :estimated_monthly_expenses, label: "Estimated monthly expenses", value: tool.estimated_monthly_expenses, unit_symbol: "$", data: { controller: "autonumeric" } %>
  </div>
  <div class="flex flex-col gap-2">
    <%= form.unit_field :one_time_expenses, label: "One-time expenses", value: tool.one_time_expenses, unit_symbol: "$", data: { controller: "autonumeric" } %>
  </div>
  <div class="mt-auto md:mt-[140px]">
    <%= form.submit "Calculate" %>
  </div>
<% end %>
<script>
  function incrementCallback(value) {
    const controller = window.Stimulus.getControllerForElementAndIdentifier(
      document.querySelector('[data-controller~="cost-of-parenting"]'),
      'cost-of-parenting'
    );
    controller.incrementChildren({ detail: { value: value } });
  }
  function decrementCallback(value) {
    const controller = window.Stimulus.getControllerForElementAndIdentifier(
      document.querySelector('[data-controller~="cost-of-parenting"]'),
      'cost-of-parenting'
    );
    controller.decrementChildren({ detail: { value: value } });
  }
</script>